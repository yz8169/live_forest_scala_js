@()(implicit flash: Flash)
<style>
		.registration-form input[type="text"], .registration-form input[type="password"], .registration-form input[type="email"] {
			padding: 10px 15px;
			height: auto;
		}

		.has-feedback .form-control {
			padding-right: 42.5px;
		}
</style>
<!DOCTYPE html>

<html lang="en">
	<head>
		<title>找回密码</title>
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" media="screen" href="@routes.Assets.at("bootstrap-sweetalert-master/dist/sweetalert.css")">
		<link rel="stylesheet" media="screen" href="@routes.Assets.at("public/bootstrapvalidator-master/dist/css/bootstrapValidator.min.css")">
		@*<link rel="stylesheet" media="screen" href="@routes.Assets.at("FormValidation/dist/css/formValidation.min.css")">*@
		<link rel="stylesheet" media="screen" href="@routes.Assets.at("bootstrap/css/bootstrap.min.css")">
		<link rel="stylesheet" media="screen" href="@routes.Assets.at("bootstrap/css/bootstrap-theme.min.css")">
		<link rel="stylesheet" media="screen" href="@routes.Assets.at("bootstrap/css/bootstrap-responsive.min.css")">
		<link rel="stylesheet" media="screen" href="@routes.Assets.at("font-awesome-4.7.0/css/font-awesome.min.css")">
		<link rel="stylesheet" media="screen" href="@routes.Assets.at("stylesheets/layout.css")">
		<link rel="stylesheet" media="screen" href="@routes.Assets.at("stylesheets/components.css")">
		<link rel="stylesheet" media="screen" href="@routes.Assets.at("stylesheets/uniform.default.css")">
		<link rel="stylesheet" media="screen" href="@routes.Assets.at("simple-line-icons/simple-line-icons.min.css")">
		<link rel="stylesheet" media="screen" href="@routes.Assets.at("stylesheets/page.css")">
		<link rel="stylesheet" media="screen" href="@routes.Assets.at("stylesheets/doc.css")">
		<link rel="stylesheet" media="screen" href="@routes.Assets.at("bootstrap-table-master/dist/bootstrap-table.min.css")">
		<link rel="stylesheet" media="screen" href="@routes.Assets.at("select2-4.0.3/dist/css/select2.min.css")">
		<link rel="stylesheet" media="screen" href="@routes.Assets.at("bootstrap-fileinput-master/css/fileinput.min.css")">
		<link rel="stylesheet" media="screen" href="@routes.Assets.at("stylesheets/login-5.min.css")">
		<link rel="stylesheet" media="screen" href="@routes.Assets.at("stylesheets/my.css")">
		<script src="@routes.Assets.at("bootstrap/js/jquery-3.1.1.min.js")" type="text/javascript"></script>
		<script src="@routes.Assets.at("bootstrap/js/bootstrap.min.js")" type="text/javascript"></script>
		<script src="@routes.Assets.at("layer-v3.0/layer/layer.js")" type="text/javascript"></script>
		<script src="@routes.Assets.at("bootstrap-sweetalert-master/dist/sweetalert.min.js")" type="text/javascript"></script>
		<script src="@routes.Assets.at("bootstrap-table-master/dist/bootstrap-table.min.js")" type="text/javascript"></script>
		<script src="@routes.Assets.at("bootstrap-table-master/dist/locale/bootstrap-table-zh-CN.min.js")" type="text/javascript"></script>
		<script src="@routes.Assets.at("select2-4.0.3/dist/js/select2.full.min.js")" type="text/javascript"></script>
		<script src="@routes.Assets.at("javascripts/bootstrap3-typeahead.min.js")" type="text/javascript"></script>
		<script src="@routes.Assets.at("bootstrap-fileinput-master/js/fileinput.min.js")" type="text/javascript"></script>
		<script src="@routes.Assets.at("bootstrap-fileinput-master/js/locales/zh.js")" type="text/javascript"></script>
		<script src="@routes.Assets.at("bootstrap-table-master/dist/extensions/export/bootstrap-table-export.js")" type="text/javascript"></script>
		<script src="@routes.Assets.at("bootstrap-table-master/dist/extensions/export/tableExport.min.js")" type="text/javascript"></script>
		<script src="@routes.Assets.at("bootstrap-table-master/dist/extensions/multiple-search/bootstrap-table-multiple-search.min.js")" type="text/javascript"></script>
		<script src="@routes.Assets.at("jquery-backstretch-master/jquery.backstretch.min.js")" type="text/javascript"></script>
		<script src="@routes.Assets.at("jquery-ui-1.12.1/jquery-ui.min.js")" type="text/javascript"></script>
		<script src="@routes.Assets.at("bootstrapvalidator-master/dist/js/bootstrapValidator.min.js")" type="text/javascript"></script>
		<script src="@routes.Assets.at("FormValidation/dist/js/formValidation.min.js")" type="text/javascript"></script>
		<script src="@routes.Assets.at("FormValidation/dist/js/framework/bootstrap.min.js")" type="text/javascript"></script>
		<script src="@routes.Assets.at("javascripts/gVerify.js")" type="text/javascript"></script>
		<script src="@routes.Assets.at("javascripts/global.js")" type="text/javascript"></script>
		<script src="@routes.Assets.at("javascripts/login.js")" type="text/javascript"></script>



	</head>
	<body class=" login">
		<style>
				.has-feedback .form-control {
					padding-right: 10px;
				}

		</style>
			<!-- BEGIN : LOGIN PAGE 5-2 -->
		<div class="user-login-5">
			<div class="row bs-reset">
				<div class="col-md-6 login-container bs-reset">

					@titleInfo()

					<div class="login-content">

						<div class="register">
							<h2 class="page-heading" style="font-size: 25px;">找回密码</h2>
						</div>
						<form id="form" style="max-width: 390px" class="registration-form form-horizontal" accept-charset="UTF-8"
						method="post" action="@routes.AppController.newPasswordActive()">

							<span class="error" style="line-height: 35px;" id="error">@flash.get("info")
							</span>


							<div class="form-group">
								<label class="control-label col-sm-4">需要找回的账号:</label>
								<div class="col-sm-8">
									<input name="name" placeholder="用户名/邮箱" autofocus="autofocus" class="form-control" required value=""/>
								</div>
							</div>

							<div class="form-group">
								<div class="col-sm-6">
									<input name="captcha" placeholder="验证码" class="form-control" id="captcha"/>
								</div>
								<div class="col-sm-6" id="v_container" style="height: 34px;
									width: 180px">

								</div>
							</div>

							<div class="actions">
								<button class="btn btn-primary btn-lg" style="width: 100%" type="submit" >
									下一步</button>
							</div>
						</form>

					</div>

					<div class="login-footer">
						<div class="row bs-reset">
							<div class="col-xs-12 bs-reset">
								<div class="login-copyright text-right">
									<p style="color: black">
										版权所有2018 深圳市绘云生物科技有限公司 All Rights Reserved
									</p>
								</div>
							</div>
						</div>
					</div>

				</div>
				<div class="col-md-6 bs-reset">
					<div class="login-bg">
					</div>

				</div>
			</div>
		</div>
	</body>
</html>

<script>
		var verifyCode;
		$(function () {

			verifyCode = new GVerify("v_container");

			$(document).on("show.bs.modal", ".modal", function () {
				$(this).draggable({
					cursor: "move",
					handle: ".modal-header"   // 只能点击头部拖动
				});
				$(this).css("overflow", "hidden"); // 防止出现滚动条，出现的话，你会把滚动条一起拖着走的
			});

			formValidation()

		})

		function formValidation() {
			$('#form').formValidation({
				framework: 'bootstrap',
				icon: {
					valid: 'glyphicon glyphicon-ok',
					invalid: 'glyphicon glyphicon-remove',
					validating: 'glyphicon glyphicon-refresh'
				},
				fields: {
					name: {
						validators: {
							notEmpty: {
								message: '用户名或邮箱不能为空！'
							},
							blank: {}
						}
					},
					captcha: {
						validators: {
							notEmpty: {
								message: "验证码不能为空！"
							},
							blank: {}
						}
					}

				}
			}).on('success.form.fv', function (e) {
				e.preventDefault();
				var $form = $(e.target),
						fv = $form.data('formValidation');
				var res = verifyCode.validate($("#captcha").val())
				if (res) {
					$.ajax({
						url: "@routes.AppController.validName()",
						type: "get",
						async: false,
						data: $("#form").serialize(),
						success: function (data) {
							if (data) {
								fv.defaultSubmit()
							} else {
								fv.updateMessage("name", 'blank', "该账户不存在！")
										.updateStatus("name", 'INVALID', 'blank');
								verifyCode.refresh()
								$("#captcha").val("")

							}
						}
					});


				} else {
					fv.updateMessage("captcha", 'blank', "验证码错误！")
							.updateStatus("captcha", 'INVALID', 'blank');
				}


			});

		}


</script>